!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.galry=b()}(this,function(){"use strict";function a(a,b){function c(){x.setOptions(b),o=f(a),d()}function d(){q=document.createElement("ul"),r=[],s=document.createElement("div"),t=document.createElement("a"),u=document.createElement("a"),v=0,p=o.getElementsByClassName(w.styles.elementsClassName);for(var a=0;a<p.length;a++){p[a].addEventListener("click",m,!1),p[a].setAttribute("data-id",a);var b=document.createElement("li"),c=document.createElement("img");q.appendChild(b),q.classList.add(w.styles.maximizedGalleryClassName),r.push(b),b.appendChild(c),b.classList.add(w.styles.elementsClassName),c.addEventListener("load",e),c.src=p[a].href}s.classList.add(w.styles.maximizedLayerClassName),s.classList.add(w.styles.maximizedLayerHiddenClassName),document.body.appendChild(s),s.appendChild(q),t.classList.add(w.styles.controlNextClassName),u.classList.add(w.styles.controlPrevClassName),s.appendChild(t),s.appendChild(u),i(),w.showThumbPanel&&"undefined"!=typeof x.thumbPanel&&x.thumbPanel.init(),w.activteTouch&&"undefined"!=typeof x.touch&&x.touch.init();var d=new CustomEvent("ready");o.dispatchEvent(d)}function e(a){var b=a.target;b.style.maxHeight=b.naturalHeight+"px",b.style.maxWidth=b.naturalWidth+"px"}function f(a){if("string"==typeof a)return document.getElementById(a);if("object"==typeof a)return a;throw"Could not find the gallery element. Please provide either an id-string, or the object itself"}function g(a){27==a.keyCode?x.minimize():38==a.keyCode||39==a.keyCode?x.next():(37==a.keyCode||40==a.keyCode)&&x.prev()}function h(a){"IMG"!==a.target.nodeName&&"A"!==a.target.nodeName&&x.minimize()}function i(){document.addEventListener("keydown",g),s.addEventListener("DOMMouseScroll",n),s.addEventListener("mousewheel",n),s.addEventListener("click",h),t.addEventListener("click",x.next),u.addEventListener("click",x.prev)}function j(){document.removeEventListener("keydown",g),s.removeEventListener("DOMMouseScroll",n),s.removeEventListener("mousewheel",n),s.removeEventListener("click",h)}function k(a){return a+1>=p.length?0:a+1}function l(a){return 0>=a?p.length-1:a-1}function m(a){a.preventDefault(),x.maximize(a.currentTarget)}function n(a){a.preventDefault(),Math.max(-1,Math.min(1,a.wheelDelta||-a.detail))>0?x.prev():x.next()}var o,p,q,r,s,t,u,v,w={styles:{elementsClassName:"gal-item",maximizedLayerHiddenClassName:"hidden",maximizedLayerClassName:"gal-maximized-layer",currentMaximizedImageClassName:"gal-current-max",nextMaximizedImageClassName:"gal-next-max",prevMaximizedImageClassName:"gal-prev-max",controlNextClassName:"gal-control-next",controlPrevClassName:"gal-control-prev",thumbPanelClassName:"gal-thumb-panel",maximizedGalleryClassName:"gal-maximized-gallery",closeButtonClassName:"gal-close-button",topBarClassName:"gal-top-bar"},closeButtonText:"close",showThumbPanel:!0,activteTouch:!0},x=this;x.setOptions=function(a){for(var b in a)w[b]&&(w[b]=a[b])},x.destroy=function(){w.showThumbPanel&&"undefined"!=typeof x.thumbPanel&&x.thumbPanel.destroy(),j(),document.body.removeChild(s)},x.getGalleryDomNode=function(){return o},x.addEventListener=function(a,b){o.addEventListener(a,b)},x.removeEventListener=function(a,b){o.removeEventListener(a,b)},x.maximize=function(a){"number"==typeof a&&(a=p[a]);var b=parseInt(a.getAttribute("data-id"),10);r[v].classList.remove(w.styles.currentMaximizedImageClassName),r[l(v)].classList.remove(w.styles.prevMaximizedImageClassName),r[k(v)].classList.remove(w.styles.nextMaximizedImageClassName),v=b,r[v].classList.add(w.styles.currentMaximizedImageClassName),r[l(v)].classList.add(w.styles.prevMaximizedImageClassName),r[k(v)].classList.add(w.styles.nextMaximizedImageClassName),s.classList.remove(w.styles.maximizedLayerHiddenClassName);var c=new CustomEvent("maximize",{detail:{currentMaximizedItemId:v}});o.dispatchEvent(c)},x.minimize=function(){s.classList.add(w.styles.maximizedLayerHiddenClassName)},x.next=function(){if(!s.classList.contains(w.styles.maximizedLayerHiddenClassName)){var a=k(v);x.maximize(p[a]);var b=new CustomEvent("nextItem",{detail:{currentMaximizedItemId:a}});o.dispatchEvent(b)}},x.prev=function(){if(!s.classList.contains(w.styles.maximizedLayerHiddenClassName)){var a=l(v);x.maximize(p[a]);var b=new CustomEvent("prevItem",{detail:{currentMaximizedItemId:a}});o.dispatchEvent(b)}},x.getCurrentItemId=function(){return v},x.thumbPanel={},function(){function a(a){for(var c=d.getElementsByClassName(w.styles.currentMaximizedImageClassName),g=e[a.detail.currentMaximizedItemId],h=c.length-1;h>=0;h--)c[h].classList.remove(w.styles.currentMaximizedImageClassName);g.classList.add(w.styles.currentMaximizedImageClassName),console.log(g.offsetLeft,f),g.offsetLeft+g.clientWidth>window.innerWidth?(f=window.innerWidth-g.offsetLeft-g.clientWidth,b(f)):g.offsetLeft+f<0&&(b(0),f=0)}function b(a){d.style.webkitTransform=d.style.MozTransform=d.style.msTransform=d.style.OTransform=d.style.transform="translate("+a+"px,0)"}var c,d,e,f=0;x.thumbPanel.init=function(){c=document.createElement("div"),d=o.cloneNode(!0),d.id="",c.classList.add(w.styles.thumbPanelClassName),s.appendChild(c),c.appendChild(d),e=d.getElementsByClassName(w.styles.elementsClassName);for(var b=e.length-1;b>=0;b--)e[b].addEventListener("click",m,!1);x.addEventListener("maximize",a)},x.thumbPanel.destroy=function(){s.removeChild(d),x.removeEventListener("maximize",a)}}(),x.touch={},function(){function a(){g=document.createElement("div"),h=document.createElement("a"),h.innerText=w.closeButtonText,h.classList.add(w.styles.closeButtonClassName),g.appendChild(h),g.classList.add(w.styles.topBarClassName),s.appendChild(g)}function b(a){f=a.changedTouches[0].screenX}function c(a){a.preventDefault();var b=a.changedTouches[0].screenX-f;r[x.getCurrentItemId()].style.webkitTransform="translate("+b+"px, 0px)"}function d(a){r[x.getCurrentItemId()].style.webkitTransform="",f>a.changedTouches[0].screenX?x.next():x.prev()}function e(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch}var f,g,h;x.touch.init=function(){e()&&(s.addEventListener("touchstart",b),s.addEventListener("touchmove",c),s.addEventListener("touchend",d),s.classList.add("touch-supported"),a(),h.addEventListener("click",x.minimize))}}(),c(this)}return a}),!function(){if("function"!=typeof window.getMatchedCSSRules){var a=/[\w-]+/g,b=/#[\w-]+/g,c=/\.[\w-]+/g,d=/\[[^\]]+\]/g,e=/\:(?!not)[\w-]+(\(.*\))?/g,f=/\:\:?(after|before|first-letter|first-line|selection)/g,g=function(a){var b=[];for(var c in a)b.push(a[c]);return b},h=function(a){var b=a.media&&a.media.mediaText;return a.disabled?[]:b&&b.length&&!window.matchMedia(b).matches?[]:g(a.cssRules)},i=function(a,b){return a.match(b),b?b.length:0},j=function(g){for(var h,j,k=[0,0,0],l=g.split(" ");h=l.shift(),"string"==typeof h;)j=i(h,f),k[2]=j,j&&(h=h.replace(f,"")),j=i(h,e),k[1]=j,j&&(h=h.replace(e,"")),j=i(h,d),k[1]+=j,j&&(h=h.replace(d,"")),j=i(h,b),k[0]=j,j&&(h=h.replace(b,"")),j=i(h,c),k[1]+=j,j&&(h=h.replace(c,"")),k[2]+=i(h,a);return parseInt(k.join(""),10)},k=function(a,b){for(var c,d,e=b.split(","),f=0;c=e.shift();)(a.mozMatchesSelector&&a.mozMatchesSelector(c)||a.msMatchesSelector&&a.msMatchesSelector(c)||a.oMatchesSelector&&a.oMatchesSelector(c)||a.webkitMatchesSelector&&a.webkitMatchesSelector(c))&&(d=j(c),f=d>f?d:f);return f},l=function(a,b){function c(b,c){return k(a,c.selectorText)-k(a,b.selectorText)}return b.sort(c)};window.getMatchedCSSRules=function(a){var b,c,d,e,f=[];for(b=g(window.document.styleSheets);c=b.shift();)for(d=h(c);e=d.shift();)e.styleSheet?d=h(e.styleSheet).concat(d):e.media?d=h(e).concat(d):(a.mozMatchesSelector&&a.mozMatchesSelector(e.selectorText)||a.msMatchesSelector&&a.msMatchesSelector(e.selectorText)||a.oMatchesSelector&&a.oMatchesSelector(e.selectorText)||a.webkitMatchesSelector&&a.webkitMatchesSelector(e.selectorText))&&f.push(e);return l(a,f)}}}(),function(){for(var a=0,b=["webkit","moz"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}(),function(a){var b={};b._debug=!1,b.observer=null,b.getComputedStyle=function(a,b){return b=b||window,b.getComputedStyle?b.getComputedStyle(a,null):a.currentStyle},b.getDefaultComputedStyle=function(a){var b=a.cloneNode(!0),c={},d=document.createElement("iframe");document.body.appendChild(d),d.contentWindow.document.open(),d.contentWindow.document.write("<body></body>"),d.contentWindow.document.body.appendChild(b),d.contentWindow.document.close();var e=d.contentWindow.document.querySelectorAll(a.nodeName.toLowerCase())[0],f=this.getComputedStyle(e,d.contentWindow);for(var g in f){var h=f.getPropertyValue?f.getPropertyValue(g):f[g];if(null!==h)switch(g){default:c[g]=h;break;case"width":case"height":case"minWidth":case"minHeight":case"maxWidth":case"maxHeight":}}return document.body.removeChild(d),c},b.getMatchedStyle=function(a,b){var c=null,d=null;a.style.getPropertyValue?d=a.style.getPropertyValue(b):a.currentStyle&&(d=a.currentStyle[b]);var e=window.getMatchedCSSRules(a);if(e.length)for(var f=e.length;f-->0;){var g=e[f],h=g.style.getPropertyPriority(b);if((null===c||h)&&(c=g.style.getPropertyValue(b),h))break}return c||null===d||(c=d),c},b.orientation=function(a){if(a.parentNode&&"x-object-fit"===a.parentNode.nodeName.toLowerCase()){var b=a.naturalWidth||a.clientWidth,c=a.naturalHeight||a.clientHeight,d=a.parentNode.clientWidth,e=a.parentNode.clientHeight;!c||b/c>d/e?"wider"!==a.getAttribute("data-x-object-relation")&&(a.setAttribute("data-x-object-relation","wider"),a.className="x-object-fit-wider",this._debug&&window.console&&console.log("x-object-fit-wider")):"taller"!==a.getAttribute("data-x-object-relation")&&(a.setAttribute("data-x-object-relation","taller"),a.className="x-object-fit-taller",this._debug&&window.console&&console.log("x-object-fit-taller"))}},b.process=function(a){if(a.selector&&a.replacedElements){switch(a.fittype=a.fittype||"none",a.fittype){default:return;case"none":case"fill":case"contain":case"cover":}var b=a.replacedElements;if(b.length)for(var c=0,d=b.length;d>c;c++)this.processElement(b[c],a)}},b.processElement=function(a,c){var d,e,f=b.getComputedStyle(a),g=b.getDefaultComputedStyle(a),h=document.createElement("x-object-fit");b._debug&&window.console&&console.log("Applying to WRAPPER-------------------------------------------------------");for(d in f)switch(d){default:e=b.getMatchedStyle(a,d),null!==e&&""!==e&&(b._debug&&window.console&&console.log(d+": "+e),h.style[d]=e);break;case"length":case"parentRule":}b._debug&&window.console&&console.log("Applying to REPLACED ELEMENT-------------------------------------------------------");for(d in g)switch(d){default:e=g[d],b._debug&&window.console&&""!==e&&console.log(d+": "+e),a.style[d]=e;break;case"length":case"parentRule":}h.setAttribute("class","x-object-fit-"+c.fittype),a.parentNode.insertBefore(h,a),h.appendChild(a),b.orientation(a);var i=null,j=function(){null!==i&&window.cancelAnimationFrame(i),i=window.requestAnimationFrame(function(){b.orientation(a)})};switch(c.fittype){default:break;case"contain":case"cover":window.addEventListener?(a.addEventListener("load",j,!1),window.addEventListener("resize",j,!1),window.addEventListener("orientationchange",j,!1)):(a.attachEvent("onload",j),window.attachEvent("onresize",j))}},b.listen=function(a){var c=function(c){for(var d=0,e=a.length;e>d;d++)(c.mozMatchesSelector&&c.mozMatchesSelector(a[d].selector)||c.msMatchesSelector&&c.msMatchesSelector(a[d].selector)||c.oMatchesSelector&&c.oMatchesSelector(a[d].selector)||c.webkitMatchesSelector&&c.webkitMatchesSelector(a[d].selector))&&(a[d].replacedElements=[c],b.process(a[d]),b._debug&&window.console&&console.log("Matching node inserted: "+c.nodeName))},d=function(a){b.observer.disconnect(),c(a),b.observer.observe(document.documentElement,{childList:!0,subtree:!0})},e=function(a){window.removeEventListener("DOMNodeInserted",e,!1),c(a.target),window.addEventListener("DOMNodeInserted",e,!1)},f=function(a){"x-object-fit"===a.nodeName.toLowerCase()&&(a.parentNode.removeChild(a),b._debug&&window.console&&console.log("Matching node removed: "+a.nodeName))},g=function(a){b.observer.disconnect(),f(a),b.observer.observe(document.documentElement,{childList:!0,subtree:!0})},h=function(a){window.removeEventListener("DOMNodeRemoved",h,!1),f(a.target.parentNode),window.addEventListener("DOMNodeRemoved",h,!1)};window.MutationObserver?(b._debug&&window.console&&console.log("DOM MutationObserver"),this.observer=new MutationObserver(function(a){a.forEach(function(a){if(a.addedNodes&&a.addedNodes.length)for(var b=a.addedNodes,c=0,e=b.length;e>c;c++)d(b[c]);a.removedNodes&&a.removedNodes.length&&g(a.target)})}),this.observer.observe(document.documentElement,{childList:!0,subtree:!0})):window.addEventListener&&(b._debug&&window.console&&console.log("DOM Mutation Events"),window.addEventListener("DOMNodeInserted",e,!1),window.addEventListener("DOMNodeRemoved",h,!1))},b.init=function(a){if(a){"Array"!=typeof a&&(a=[a]);for(var b=0,c=a.length;c>b;b++)a[b].replacedElements=document.querySelectorAll(a[b].selector),this.process(a[b]);this.listen(a)}},b.polyfill=function(a){"objectFit"in document.documentElement.style==0?(b._debug&&window.console&&console.log("object-fit not natively supported"),"complete"===document.readyState?b.init(a):window.addEventListener?window.addEventListener("load",function(){b.init(a)},!1):window.attachEvent("onload",function(){b.init(a)})):b._debug&&window.console&&console.log("object-fit natively supported")},a.objectFit=b}(window);