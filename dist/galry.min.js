!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.galry=b()}(this,function(){"use strict";function a(a,b){function c(){y.setOptions(b),o=f(a),d()}function d(){q=document.createElement("ul"),r=[],s=[],t=document.createElement("div"),u=document.createElement("a"),v=document.createElement("a"),w=0,p=o.getElementsByClassName(x.styles.elementsClassName);for(var a=0;a<p.length;a++){p[a].addEventListener("click",m,!1),p[a].setAttribute("data-id",a);var b=document.createElement("li"),c=document.createElement("img");q.appendChild(b),q.classList.add(x.styles.maximizedGalleryClassName),r.push(b),s.push(c),b.appendChild(c),b.classList.add(x.styles.elementsClassName),c.addEventListener("load",e),c.src=p[a].href}t.classList.add(x.styles.maximizedLayerClassName),t.classList.add(x.styles.maximizedLayerHiddenClassName),document.body.appendChild(t),t.appendChild(q),u.classList.add(x.styles.controlNextClassName),v.classList.add(x.styles.controlPrevClassName),t.appendChild(u),t.appendChild(v),i(),x.showThumbPanel&&"undefined"!=typeof y.thumbPanel&&y.thumbPanel.init(),x.activteTouch&&"undefined"!=typeof y.touch&&y.touch.init(),x.showMeta&&"undefined"!=typeof y.meta&&y.meta.init();var d=new CustomEvent("ready");o.dispatchEvent(d)}function e(a){var b=a.target;b.style.maxHeight=b.naturalHeight+"px",b.style.maxWidth=b.naturalWidth+"px"}function f(a){if("string"==typeof a)return document.getElementById(a);if("object"==typeof a)return a;throw"Could not find the gallery element. Please provide either an id-string, or the object itself"}function g(a){27==a.keyCode?y.minimize():38==a.keyCode||39==a.keyCode?y.next():(37==a.keyCode||40==a.keyCode)&&y.prev()}function h(a){"IMG"!==a.target.nodeName&&"A"!==a.target.nodeName&&y.minimize()}function i(){document.addEventListener("keydown",g),t.addEventListener("DOMMouseScroll",n),t.addEventListener("mousewheel",n),t.addEventListener("click",h),u.addEventListener("click",y.next),v.addEventListener("click",y.prev)}function j(){document.removeEventListener("keydown",g),t.removeEventListener("DOMMouseScroll",n),t.removeEventListener("mousewheel",n),t.removeEventListener("click",h)}function k(a){return a+1>=p.length?0:a+1}function l(a){return 0>=a?p.length-1:a-1}function m(a){a.preventDefault(),y.maximize(a.currentTarget)}function n(a){a.preventDefault(),Math.max(-1,Math.min(1,a.wheelDelta||-a.detail))>0?y.prev():y.next()}var o,p,q,r,s,t,u,v,w,x={styles:{elementsClassName:"gal-item",maximizedLayerHiddenClassName:"hidden",maximizedLayerClassName:"gal-maximized-layer",currentMaximizedImageClassName:"gal-current-max",nextMaximizedImageClassName:"gal-next-max",prevMaximizedImageClassName:"gal-prev-max",controlNextClassName:"gal-control-next",controlPrevClassName:"gal-control-prev",thumbPanelClassName:"gal-thumb-panel",maximizedGalleryClassName:"gal-maximized-gallery",closeButtonClassName:"gal-close-button",topBarClassName:"gal-top-bar",metaBoxClassName:"gal-meta-box"},closeButtonText:"close",showThumbPanel:!0,activteTouch:!0,showMeta:!0},y=this;y.setOptions=function(a){for(var b in a)x[b]&&(x[b]=a[b])},y.destroy=function(){x.showThumbPanel&&"undefined"!=typeof y.thumbPanel&&y.thumbPanel.destroy(),j(),document.body.removeChild(t)},y.getGalleryDomNode=function(){return o},y.addEventListener=function(a,b){o.addEventListener(a,b)},y.removeEventListener=function(a,b){o.removeEventListener(a,b)},y.maximize=function(a){"number"==typeof a&&(a=p[a]);var b=parseInt(a.getAttribute("data-id"),10),c=w;r[w].classList.remove(x.styles.currentMaximizedImageClassName),r[l(w)].classList.remove(x.styles.prevMaximizedImageClassName),r[k(w)].classList.remove(x.styles.nextMaximizedImageClassName),w=b,r[w].classList.add(x.styles.currentMaximizedImageClassName),r[l(w)].classList.add(x.styles.prevMaximizedImageClassName),r[k(w)].classList.add(x.styles.nextMaximizedImageClassName),t.classList.remove(x.styles.maximizedLayerHiddenClassName);var d=s[w],e=.9*window.innerWidth;if(d.clientWidth>e){var f=d.width/d.height;d.style.width=e+"px",d.style.height=e/f+"px"}var g=new CustomEvent("maximize",{detail:{currentMaximizedItemId:w,lastMaximizdItemId:c}});o.dispatchEvent(g)},y.minimize=function(){t.classList.add(x.styles.maximizedLayerHiddenClassName)},y.next=function(){if(!t.classList.contains(x.styles.maximizedLayerHiddenClassName)){var a=k(w);y.maximize(p[a]);var b=new CustomEvent("nextItem",{detail:{currentMaximizedItemId:a}});o.dispatchEvent(b)}},y.prev=function(){if(!t.classList.contains(x.styles.maximizedLayerHiddenClassName)){var a=l(w);y.maximize(p[a]);var b=new CustomEvent("prevItem",{detail:{currentMaximizedItemId:a}});o.dispatchEvent(b)}},y.getCurrentItemId=function(){return w},y.thumbPanel={},function(){function a(a){for(var c=d.getElementsByClassName(x.styles.currentMaximizedImageClassName),g=e[a.detail.currentMaximizedItemId],h=c.length-1;h>=0;h--)c[h].classList.remove(x.styles.currentMaximizedImageClassName);g.classList.add(x.styles.currentMaximizedImageClassName),g.offsetLeft+g.clientWidth>window.innerWidth?(f=window.innerWidth-g.offsetLeft-g.clientWidth,b(f)):g.offsetLeft+f<0&&(b(0),f=0)}function b(a){d.style.webkitTransform=d.style.MozTransform=d.style.msTransform=d.style.OTransform=d.style.transform="translate("+a+"px,0)"}var c,d,e,f=0;y.thumbPanel.init=function(){c=document.createElement("div"),d=o.cloneNode(!0),d.className="",d.id="",c.classList.add(x.styles.thumbPanelClassName),t.appendChild(c),c.appendChild(d),e=d.getElementsByClassName(x.styles.elementsClassName);for(var b=e.length-1;b>=0;b--)e[b].addEventListener("click",m,!1);y.addEventListener("maximize",a)},y.thumbPanel.destroy=function(){t.removeChild(c),y.removeEventListener("maximize",a)},y.thumbPanel.getThumbPanelDomNode=function(){return c}}(),y.touch={},function(){function a(){g=document.createElement("div"),h=document.createElement("a"),h.innerText=x.closeButtonText,h.classList.add(x.styles.closeButtonClassName),g.appendChild(h),g.classList.add(x.styles.topBarClassName),t.appendChild(g)}function b(a){f=a.changedTouches[0].screenX}function c(a){a.preventDefault();var b=a.changedTouches[0].screenX-f;r[y.getCurrentItemId()].style.webkitTransform="translate("+b+"px, 0px)"}function d(a){r[y.getCurrentItemId()].style.webkitTransform="",f>a.changedTouches[0].screenX?y.next():y.prev()}function e(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch}var f,g,h;y.touch.init=function(){e()&&(t.addEventListener("touchstart",b),t.addEventListener("touchmove",c),t.addEventListener("touchend",d),t.classList.add("touch-supported"),a(),h.addEventListener("click",y.minimize))}}(),y.meta={},function(){function a(a){var c=a.detail.lastMaximizedItemId,f=a.detail.currentMaximizedItemId;e&&r[c].removeChild(b),p[f].hasAttribute("data-meta")&&(d.innerText=p[f].getAttribute("data-meta"),b.style.width=s[f].clientWidth+"px",b.style.height=s[f].clientHeight+"px",b.style.marginLeft=-s[f].clientWidth/2+"px",b.style.marginTop=-s[f].clientHeight/2+"px",r[f].appendChild(b))}var b,c,d,e=!1;y.meta.init=function(){b=document.createElement("div"),c=document.createElement("div"),d=document.createElement("p"),b.appendChild(c),c.appendChild(d),b.classList.add(x.styles.metaBoxClassName),y.addEventListener("maximize",a)}}(),c(this)}return a});