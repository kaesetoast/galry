!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.galry=b()}(this,function(){"use strict";function a(a,b){function c(){x.setOptions(b),s=k(a),e()}function d(a,b){if("object"==typeof a){var c={};for(var e in a)c[e]=d(a[e],b[e]);return c}return"undefined"!=typeof b?b:a}function e(){u=0,f(),g(),m(),h(x.GALLERY_READY_HOOK);var a=new CustomEvent("ready");s.dispatchEvent(a)}function f(){v.lightbox&&"undefined"!==x.lightbox&&x.lightbox.init(),v.showThumbPanel&&"undefined"!=typeof x.thumbPanel&&x.thumbPanel.init(),v.activateTouch&&"undefined"!=typeof x.touch&&x.touch.init(),v.showMeta&&"undefined"!=typeof x.meta&&x.meta.init()}function g(){t=s.getElementsByClassName(v.styles.elementsClassName);for(var a=0;a<t.length;a++)t[a].setAttribute("data-id",a),h(x.GALLERY_ITEM_CREATION_HOOK,t[a]);i()}function h(a,b){var c=w[a];if("undefined"!=typeof c)for(var d=c.length;d--;)c[d].call(c[d],b)}function i(){j(),t[u].classList.add(v.styles.currentItemClassName),t[p(u)].classList.add(v.styles.nextItemClassName),t[q(u)].classList.add(v.styles.prevItemClassName)}function j(){for(var a=t.length-1;a>=0;a--)t[a].classList.remove(v.styles.currentItemClassName),t[a].classList.remove(v.styles.nextItemClassName),t[a].classList.remove(v.styles.prevItemClassName)}function k(a){if("string"==typeof a)return document.getElementById(a);if("object"==typeof a)return a;throw"Could not find the gallery element. Please provide either an id-string, or the object itself"}function l(a){38==a.keyCode||39==a.keyCode?x.next():(37==a.keyCode||40==a.keyCode)&&x.prev()}function m(){document.addEventListener("keydown",l)}function n(){document.removeEventListener("keydown",l)}function o(a,b){var c=new CustomEvent(a,{detail:b});s.dispatchEvent(c)}function p(a){return a+1>=t.length?0:a+1}function q(a){return 0>=a?t.length-1:a-1}function r(a){a.preventDefault(),Math.max(-1,Math.min(1,a.wheelDelta||-a.detail))>0?x.prev():x.next()}var s,t,u,v={styles:{elementsClassName:"gal-item",maximizedLayerHiddenClassName:"hidden",maximizedLayerClassName:"gal-maximized-layer",currentItemClassName:"gal-current-item",nextItemClassName:"gal-next-item",prevItemClassName:"gal-prev-item",controlNextClassName:"gal-control-next",controlPrevClassName:"gal-control-prev",thumbPanelClassName:"gal-thumb-panel",maximizedGalleryClassName:"gal-maximized-gallery",closeButtonClassName:"gal-close-button",topBarClassName:"gal-top-bar",metaBoxClassName:"gal-meta-box"},closeButtonText:"X",showThumbPanel:!0,activateTouch:!0,showMeta:!0,lightbox:!0},w={},x=this;x.GALLERY_ITEM_CREATION_HOOK="gallery-item-creation-hook",x.GALLERY_READY_HOOK="gallery-ready-hook",x.setOptions=function(a){for(var b in a)v[b]&&(v[b]=d(v[b],a[b]))},x.destroy=function(){v.lightbox&&"undefined"!=typeof x.lightbox&&x.lightbox.destroy(),v.showThumbPanel&&"undefined"!=typeof x.thumbPanel&&x.thumbPanel.destroy(),j(),n()},x.getGalleryDomNode=function(){return s},x.addEventListener=function(a,b){s.addEventListener(a,b)},x.removeEventListener=function(a,b){s.removeEventListener(a,b)},x.addHook=function(a,b){"undefined"==typeof w[a]&&(w[a]=[]),w[a].push(b)},x.next=function(){var a=p(u);x.goTo(t[a]),o("nextItem",{currentItemId:a})},x.prev=function(){var a=q(u);x.goTo(t[a]),o("prevItem",{currentItemId:a})},x.goTo=function(a){var b,c=u;"number"==typeof a?(b=a,a=t[a]):b=parseInt(a.getAttribute("data-id"),10),t.length>b&&(u=b,i()),o("changeItem",{currentItemId:u,oldItemId:c})},x.getCurrentItemId=function(){return u},x.lightbox={},function(){function a(){var a=m[u],b=.9*window.innerWidth;if(a.clientWidth>b){var c=a.width/a.height;a.style.width=b+"px",a.style.height=b/c+"px"}}function b(a){c(a),a.addEventListener("click",d,!1)}function c(a){var b=document.createElement("li"),c=document.createElement("img");k.appendChild(b),k.classList.add(v.styles.maximizedGalleryClassName),l.push(b),m.push(c),b.appendChild(c),b.classList.add(v.styles.elementsClassName),c.addEventListener("load",f),c.src=a.href}function d(a){a.preventDefault(),x.maximize(a.currentTarget)}function e(b){var c=b.detail.oldItemId,d=b.detail.currentItemId;l[c].classList.remove(v.styles.currentItemClassName),l[p(c)].classList.remove(v.styles.nextItemClassName),l[q(c)].classList.remove(v.styles.prevItemClassName),l[d].classList.add(v.styles.currentItemClassName),l[p(d)].classList.add(v.styles.nextItemClassName),l[q(d)].classList.add(v.styles.prevItemClassName),a(),o("changeMaximizedItem",{currentItemId:d})}function f(a){var b=a.target;b.style.maxHeight=b.naturalHeight+"px",b.style.maxWidth=b.naturalWidth+"px"}function g(){x.addEventListener("changeItem",e),document.addEventListener("keydown",i),n.addEventListener("DOMMouseScroll",r),n.addEventListener("mousewheel",r),n.addEventListener("click",j),s.addEventListener("click",x.next),w.addEventListener("click",x.prev)}function h(){x.removeEventListener("changeItem",e);for(var a=t.length-1;a>=0;a--)t[a].removeEventListener("click",d);document.removeEventListener("keydown",i),n.removeEventListener("DOMMouseScroll",r),n.removeEventListener("mousewheel",r),n.removeEventListener("click",j)}function i(a){27===a.keyCode&&x.minimize()}function j(a){"IMG"!==a.target.nodeName&&"A"!==a.target.nodeName&&x.minimize()}var k,l,m,n,s,w;x.lightbox.init=function(){k=document.createElement("ul"),l=[],m=[],n=document.createElement("div"),n.classList.add(v.styles.maximizedLayerClassName),n.classList.add(v.styles.maximizedLayerHiddenClassName),document.body.appendChild(n),n.appendChild(k),s=document.createElement("a"),w=document.createElement("a"),s.classList.add(v.styles.controlNextClassName),w.classList.add(v.styles.controlPrevClassName),n.appendChild(s),n.appendChild(w),x.addHook(x.GALLERY_ITEM_CREATION_HOOK,b),g()},x.lightbox.destroy=function(){document.body.removeChild(n),h()},x.lightbox.getMaximizedLayer=function(){return n},x.lightbox.getMaximizedGalleryItems=function(){return l},x.lightbox.getMaximizedGalleryImages=function(){return m},x.maximize=function(b){"number"==typeof b&&(b=t[b]);var c=parseInt(b.getAttribute("data-id"),10);x.goTo(c),n.classList.remove(v.styles.maximizedLayerHiddenClassName),a(),o("maximize",{currentItemId:u})},x.minimize=function(){n.classList.add(v.styles.maximizedLayerHiddenClassName)}}(),x.meta={},function(){function a(a){if(h=a.detail.currentItemId,i){for(var d=x.lightbox.getMaximizedLayer().getElementsByClassName(v.styles.metaBoxClassName),g=d.length-1;g>=0;g--)d[g].parentNode.removeChild(d[g]);i=!1}t[h].hasAttribute("data-meta")&&(b(),e.innerText=t[h].getAttribute("data-meta"),f[h].appendChild(c),i=!0)}function b(){return 0===g[h].clientWidth?void(j=setTimeout(b,1)):(c.style.width=g[h].clientWidth+"px",c.style.height=g[h].clientHeight+"px",c.style.marginLeft=-g[h].clientWidth/2+"px",void(c.style.marginTop=-g[h].clientHeight/2+"px"))}var c,d,e,f,g,h,i=!1,j=!1;x.meta.init=function(){c=document.createElement("div"),d=document.createElement("div"),e=document.createElement("p"),c.appendChild(d),d.appendChild(e),c.classList.add(v.styles.metaBoxClassName),x.addEventListener("changeMaximizedItem",a),f=x.lightbox.getMaximizedGalleryItems(),g=x.lightbox.getMaximizedGalleryImages()}}(),x.thumbPanel={},function(){function a(){f=s.cloneNode(!0),f.className="",f.id="",e.classList.add(v.styles.thumbPanelClassName),x.lightbox.getMaximizedLayer().appendChild(e),e.appendChild(f),g=f.getElementsByClassName(v.styles.elementsClassName);for(var a=g.length-1;a>=0;a--)g[a].addEventListener("click",c,!1)}function b(a){for(var b=f.getElementsByClassName(v.styles.currentItemClassName),c=g[a.detail.currentItemId],e=b.length-1;e>=0;e--)b[e].classList.remove(v.styles.currentItemClassName);c.classList.add(v.styles.currentItemClassName),c.offsetLeft+c.clientWidth>window.innerWidth?(h=window.innerWidth-c.offsetLeft-c.clientWidth,d(h)):c.offsetLeft+h<0&&(d(0),h=0)}function c(a){a.preventDefault(),x.maximize(a.currentTarget)}function d(a){f.style.webkitTransform=f.style.MozTransform=f.style.msTransform=f.style.OTransform=f.style.transform="translate("+a+"px,0)"}var e,f,g,h=0;x.thumbPanel.init=function(){e=document.createElement("div"),x.addEventListener("changeItem",b),x.addHook(x.GALLERY_READY_HOOK,a)},x.thumbPanel.destroy=function(){x.lightbox.getMaximizedLayer().removeChild(e),x.removeEventListener("changeItem",b)},x.thumbPanel.getThumbPanelDomNode=function(){return e}}(),x.touch={},function(){function a(){g=document.createElement("a"),g.innerText=v.closeButtonText,g.classList.add(v.styles.closeButtonClassName),h.appendChild(g),g.addEventListener("click",x.minimize)}function b(a){f=a.changedTouches[0].screenX}function c(a){a.preventDefault();var b=a.changedTouches[0].screenX-f;i[x.getCurrentItemId()].style.webkitTransform="translate("+b+"px, 0px)"}function d(a){i[x.getCurrentItemId()].style.webkitTransform="",f>a.changedTouches[0].screenX?x.next():x.prev()}function e(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch}var f,g,h,i;x.touch.init=function(){e()&&(h=x.lightbox.getMaximizedLayer(),i=x.lightbox.getMaximizedGalleryItems(),h.addEventListener("touchstart",b),h.addEventListener("touchmove",c),h.addEventListener("touchend",d),h.classList.add("touch-supported"),a())}}(),c(this)}return a});