!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.galry=b()}(this,function(){"use strict";function a(a,b){function c(){w.setOptions(b),r=j(a),d()}function d(){t=0,e(),f(),l(),g(w.GALLERY_READY_HOOK);var a=new CustomEvent("ready");r.dispatchEvent(a)}function e(){u.lightbox&&"undefined"!==w.lightbox&&w.lightbox.init(),u.showThumbPanel&&"undefined"!=typeof w.thumbPanel&&w.thumbPanel.init(),u.activateTouch&&"undefined"!=typeof w.touch&&w.touch.init(),u.showMeta&&"undefined"!=typeof w.meta&&w.meta.init()}function f(){s=r.getElementsByClassName(u.styles.elementsClassName);for(var a=0;a<s.length;a++)s[a].setAttribute("data-id",a),g(w.GALLERY_ITEM_CREATION_HOOK,s[a]);h()}function g(a,b){var c=v[a];if("undefined"!=typeof c)for(var d=c.length;d--;)c[d].call(c[d],b)}function h(){i(),s[t].classList.add(u.styles.currentItemClassName),s[o(t)].classList.add(u.styles.nextItemClassName),s[p(t)].classList.add(u.styles.prevItemClassName)}function i(){for(var a=s.length-1;a>=0;a--)s[a].classList.remove(u.styles.currentItemClassName),s[a].classList.remove(u.styles.nextItemClassName),s[a].classList.remove(u.styles.prevItemClassName)}function j(a){if("string"==typeof a)return document.getElementById(a);if("object"==typeof a)return a;throw"Could not find the gallery element. Please provide either an id-string, or the object itself"}function k(a){38==a.keyCode||39==a.keyCode?w.next():(37==a.keyCode||40==a.keyCode)&&w.prev()}function l(){document.addEventListener("keydown",k)}function m(){document.removeEventListener("keydown",k)}function n(a,b){var c=new CustomEvent(a,{detail:b});r.dispatchEvent(c)}function o(a){return a+1>=s.length?0:a+1}function p(a){return 0>=a?s.length-1:a-1}function q(a){a.preventDefault(),Math.max(-1,Math.min(1,a.wheelDelta||-a.detail))>0?w.prev():w.next()}var r,s,t,u={styles:{elementsClassName:"gal-item",maximizedLayerHiddenClassName:"hidden",maximizedLayerClassName:"gal-maximized-layer",currentItemClassName:"gal-current-item",nextItemClassName:"gal-next-item",prevItemClassName:"gal-prev-item",controlNextClassName:"gal-control-next",controlPrevClassName:"gal-control-prev",thumbPanelClassName:"gal-thumb-panel",maximizedGalleryClassName:"gal-maximized-gallery",closeButtonClassName:"gal-close-button",topBarClassName:"gal-top-bar",metaBoxClassName:"gal-meta-box"},closeButtonText:"X",showThumbPanel:!0,activateTouch:!0,showMeta:!0,lightbox:!0},v={},w=this;w.GALLERY_ITEM_CREATION_HOOK="gallery-item-creation-hook",w.GALLERY_READY_HOOK="gallery-ready-hook",w.setOptions=function(a){for(var b in a)u[b]&&(u[b]=a[b])},w.destroy=function(){u.lightbox&&"undefined"!=typeof w.lightbox&&w.lightbox.destroy(),u.showThumbPanel&&"undefined"!=typeof w.thumbPanel&&w.thumbPanel.destroy(),i(),m()},w.getGalleryDomNode=function(){return r},w.addEventListener=function(a,b){r.addEventListener(a,b)},w.removeEventListener=function(a,b){r.removeEventListener(a,b)},w.addHook=function(a,b){"undefined"==typeof v[a]&&(v[a]=[]),v[a].push(b)},w.next=function(){var a=o(t);w.goTo(s[a]),n("nextItem",{currentItemId:a})},w.prev=function(){var a=p(t);w.goTo(s[a]),n("prevItem",{currentItemId:a})},w.goTo=function(a){var b,c=t;"number"==typeof a?(b=a,a=s[a]):b=parseInt(a.getAttribute("data-id"),10),s.length>b&&(t=b,h()),n("changeItem",{currentItemId:t,oldItemId:c})},w.getCurrentItemId=function(){return t},w.lightbox={},function(){function a(a){b(a),a.addEventListener("click",c,!1)}function b(a){var b=document.createElement("li"),c=document.createElement("img");j.appendChild(b),j.classList.add(u.styles.maximizedGalleryClassName),k.push(b),l.push(c),b.appendChild(c),b.classList.add(u.styles.elementsClassName),c.addEventListener("load",e),c.src=a.href}function c(a){a.preventDefault(),w.maximize(a.currentTarget)}function d(a){var b=a.detail.oldItemId,c=a.detail.currentItemId;k[b].classList.remove(u.styles.currentItemClassName),k[o(b)].classList.remove(u.styles.nextItemClassName),k[p(b)].classList.remove(u.styles.prevItemClassName),k[c].classList.add(u.styles.currentItemClassName),k[o(c)].classList.add(u.styles.nextItemClassName),k[p(c)].classList.add(u.styles.prevItemClassName),n("changeMaximizedItem",{currentItemId:c})}function e(a){var b=a.target;b.style.maxHeight=b.naturalHeight+"px",b.style.maxWidth=b.naturalWidth+"px"}function f(){w.addEventListener("changeItem",d),document.addEventListener("keydown",h),m.addEventListener("DOMMouseScroll",q),m.addEventListener("mousewheel",q),m.addEventListener("click",i),r.addEventListener("click",w.next),v.addEventListener("click",w.prev)}function g(){w.removeEventListener("changeItem",d);for(var a=s.length-1;a>=0;a--)s[a].removeEventListener("click",c);document.removeEventListener("keydown",h),m.removeEventListener("DOMMouseScroll",q),m.removeEventListener("mousewheel",q),m.removeEventListener("click",i)}function h(a){27===a.keyCode&&w.minimize()}function i(a){"IMG"!==a.target.nodeName&&"A"!==a.target.nodeName&&w.minimize()}var j,k,l,m,r,v;w.lightbox.init=function(){j=document.createElement("ul"),k=[],l=[],m=document.createElement("div"),m.classList.add(u.styles.maximizedLayerClassName),m.classList.add(u.styles.maximizedLayerHiddenClassName),document.body.appendChild(m),m.appendChild(j),r=document.createElement("a"),v=document.createElement("a"),r.classList.add(u.styles.controlNextClassName),v.classList.add(u.styles.controlPrevClassName),m.appendChild(r),m.appendChild(v),w.addHook(w.GALLERY_ITEM_CREATION_HOOK,a),f()},w.lightbox.destroy=function(){document.body.removeChild(m),g()},w.lightbox.getMaximizedLayer=function(){return m},w.lightbox.getMaximizedGalleryItems=function(){return k},w.lightbox.getMaximizedGalleryImages=function(){return l},w.maximize=function(a){"number"==typeof a&&(a=s[a]);var b=parseInt(a.getAttribute("data-id"),10);w.goTo(b),m.classList.remove(u.styles.maximizedLayerHiddenClassName);var c=l[t],d=.9*window.innerWidth;if(c.clientWidth>d){var e=c.width/c.height;c.style.width=d+"px",c.style.height=d/e+"px"}n("maximize",{currentItemId:t})},w.minimize=function(){m.classList.add(u.styles.maximizedLayerHiddenClassName)}}(),w.meta={},function(){function a(a){if(h=a.detail.currentItemId,i){for(var d=w.lightbox.getMaximizedLayer().getElementsByClassName(u.styles.metaBoxClassName),g=d.length-1;g>=0;g--)d[g].parentNode.removeChild(d[g]);i=!1}s[h].hasAttribute("data-meta")&&(b(),e.innerText=s[h].getAttribute("data-meta"),f[h].appendChild(c),i=!0)}function b(){return 0===g[h].clientWidth?(j=setTimeout(b,1),void 0):(c.style.width=g[h].clientWidth+"px",c.style.height=g[h].clientHeight+"px",c.style.marginLeft=-g[h].clientWidth/2+"px",c.style.marginTop=-g[h].clientHeight/2+"px",void 0)}var c,d,e,f,g,h,i=!1,j=!1;w.meta.init=function(){c=document.createElement("div"),d=document.createElement("div"),e=document.createElement("p"),c.appendChild(d),d.appendChild(e),c.classList.add(u.styles.metaBoxClassName),w.addEventListener("changeMaximizedItem",a),f=w.lightbox.getMaximizedGalleryItems(),g=w.lightbox.getMaximizedGalleryImages()}}(),w.thumbPanel={},function(){function a(){f=r.cloneNode(!0),f.className="",f.id="",e.classList.add(u.styles.thumbPanelClassName),w.lightbox.getMaximizedLayer().appendChild(e),e.appendChild(f),g=f.getElementsByClassName(u.styles.elementsClassName);for(var a=g.length-1;a>=0;a--)g[a].addEventListener("click",c,!1)}function b(a){for(var b=f.getElementsByClassName(u.styles.currentItemClassName),c=g[a.detail.currentItemId],e=b.length-1;e>=0;e--)b[e].classList.remove(u.styles.currentItemClassName);c.classList.add(u.styles.currentItemClassName),c.offsetLeft+c.clientWidth>window.innerWidth?(h=window.innerWidth-c.offsetLeft-c.clientWidth,d(h)):c.offsetLeft+h<0&&(d(0),h=0)}function c(a){a.preventDefault(),w.maximize(a.currentTarget)}function d(a){f.style.webkitTransform=f.style.MozTransform=f.style.msTransform=f.style.OTransform=f.style.transform="translate("+a+"px,0)"}var e,f,g,h=0;w.thumbPanel.init=function(){e=document.createElement("div"),w.addEventListener("changeItem",b),w.addHook(w.GALLERY_READY_HOOK,a)},w.thumbPanel.destroy=function(){w.lightbox.getMaximizedLayer().removeChild(e),w.removeEventListener("changeItem",b)},w.thumbPanel.getThumbPanelDomNode=function(){return e}}(),w.touch={},function(){function a(){g=document.createElement("a"),g.innerText=u.closeButtonText,g.classList.add(u.styles.closeButtonClassName),h.appendChild(g),g.addEventListener("click",w.minimize)}function b(a){f=a.changedTouches[0].screenX}function c(a){a.preventDefault();var b=a.changedTouches[0].screenX-f;i[w.getCurrentItemId()].style.webkitTransform="translate("+b+"px, 0px)"}function d(a){i[w.getCurrentItemId()].style.webkitTransform="",f>a.changedTouches[0].screenX?w.next():w.prev()}function e(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch}var f,g,h,i;w.touch.init=function(){e()&&(h=w.lightbox.getMaximizedLayer(),i=w.lightbox.getMaximizedGalleryItems(),h.addEventListener("touchstart",b),h.addEventListener("touchmove",c),h.addEventListener("touchend",d),h.classList.add("touch-supported"),a())}}(),c(this)}return a});